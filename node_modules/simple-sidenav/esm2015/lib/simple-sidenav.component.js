/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Component, Input, ViewEncapsulation, Output, EventEmitter } from '@angular/core';
import { fadeIn, fadeOut, rotate } from './animations/animations';
import * as ɵngcc0 from '@angular/core';
import * as ɵngcc1 from '@angular/common';

function SimpleSidenavComponent_div_0_div_1_img_2_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelement(0, "img", 9);
} if (rf & 2) {
    const item_r2 = ɵngcc0.ɵɵnextContext().$implicit;
    ɵngcc0.ɵɵproperty("src", item_r2.icon, ɵngcc0.ɵɵsanitizeUrl);
} }
function SimpleSidenavComponent_div_0_div_1_span_5_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "span", 10);
    ɵngcc0.ɵɵnamespaceSVG();
    ɵngcc0.ɵɵelementStart(1, "svg", 11);
    ɵngcc0.ɵɵelement(2, "path", 12);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const item_r2 = ɵngcc0.ɵɵnextContext().$implicit;
    const ctx_r5 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵproperty("@rotate", item_r2.id === ctx_r5.activeOne.id && ctx_r5.activeOne.menu ? "rotated" : "default");
} }
const _c0 = function (a0) { return { "active": a0 }; };
function SimpleSidenavComponent_div_0_div_1_Template(rf, ctx) { if (rf & 1) {
    const _r9 = ɵngcc0.ɵɵgetCurrentView();
    ɵngcc0.ɵɵelementStart(0, "div", 3);
    ɵngcc0.ɵɵelementStart(1, "div", 4);
    ɵngcc0.ɵɵlistener("click", function SimpleSidenavComponent_div_0_div_1_Template_div_click_1_listener() { const restoredCtx = ɵngcc0.ɵɵrestoreView(_r9); const item_r2 = restoredCtx.$implicit; const menuIndex_r3 = restoredCtx.index; const ctx_r8 = ɵngcc0.ɵɵnextContext(2); return ctx_r8.onNavClick(item_r2, menuIndex_r3); });
    ɵngcc0.ɵɵtemplate(2, SimpleSidenavComponent_div_0_div_1_img_2_Template, 1, 1, "img", 5);
    ɵngcc0.ɵɵelementStart(3, "span", 6);
    ɵngcc0.ɵɵtext(4);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵtemplate(5, SimpleSidenavComponent_div_0_div_1_span_5_Template, 3, 1, "span", 7);
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementStart(6, "sm-simple-sidenav", 8);
    ɵngcc0.ɵɵlistener("onSidenav", function SimpleSidenavComponent_div_0_div_1_Template_sm_simple_sidenav_onSidenav_6_listener($event) { ɵngcc0.ɵɵrestoreView(_r9); const ctx_r10 = ɵngcc0.ɵɵnextContext(2); return ctx_r10.onSidenav.emit($event); });
    ɵngcc0.ɵɵelementEnd();
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const item_r2 = ctx.$implicit;
    const ctx_r1 = ɵngcc0.ɵɵnextContext(2);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngClass", ɵngcc0.ɵɵpureFunction1(10, _c0, item_r2.id === ctx_r1.activeOne.id));
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", item_r2.icon);
    ɵngcc0.ɵɵadvance(2);
    ɵngcc0.ɵɵtextInterpolate(item_r2.name);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngIf", ctx_r1.withArrow && item_r2.menu);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("animate", true)("activeID", ctx_r1.activeID)("animation", ctx_r1.animation)("menu", ctx_r1.activeOne.menu)("withArrow", ctx_r1.withArrow)("show", item_r2.id === ctx_r1.activeOne.id && item_r2.menu);
} }
function SimpleSidenavComponent_div_0_Template(rf, ctx) { if (rf & 1) {
    ɵngcc0.ɵɵelementStart(0, "div", 1);
    ɵngcc0.ɵɵtemplate(1, SimpleSidenavComponent_div_0_div_1_Template, 7, 12, "div", 2);
    ɵngcc0.ɵɵelementEnd();
} if (rf & 2) {
    const ctx_r0 = ɵngcc0.ɵɵnextContext();
    ɵngcc0.ɵɵproperty("@fadeIn", ctx_r0.animate && ctx_r0.animation && ctx_r0.animation.in)("@close", ctx_r0.animate && ctx_r0.animation && ctx_r0.animation.out);
    ɵngcc0.ɵɵadvance(1);
    ɵngcc0.ɵɵproperty("ngForOf", ctx_r0.menu);
} }
export class SimpleSidenavComponent {
    constructor() {
        this.menu = [];
        this.show = true;
        this.animate = false;
        this.withArrow = true;
        this.onSidenav = new EventEmitter();
        this.activeOne = {};
    }
    /**
     * @param {?} changes
     * @return {?}
     */
    ngOnChanges(changes) {
        this.activeOne = {};
        if (changes.activeID && changes.activeID.currentValue) {
            this.activeID = changes.activeID.currentValue;
            this.activeID && this.menu && this.findActive();
        }
    }
    /**
     * @param {?} __0
     * @param {?} index
     * @return {?}
     */
    onNavClick({ id, name, icon }, index) {
        if (this.activeOne.id === id && this.activeOne.menu) {
            this.activeOne = {};
            this.onSidenav.emit(null);
            return;
        }
        this.onSidenav.emit({ id, name, icon, index });
        this.activeOne = { id, name, icon };
        if (this.menu[index].menu) {
            this.activeOne.menu = this.menu[index].menu;
        }
    }
    /**
     * @return {?}
     */
    findActive() {
        this.menu.forEach((item) => {
            if (item.id === this.activeID || this.hasActive(item.menu)) {
                this.activeOne = item;
                return;
            }
        });
    }
    /**
     * @param {?} menu
     * @return {?}
     */
    hasActive(menu) {
        return menu && menu.some(item => item.id === this.activeID || this.hasActive(item.menu));
    }
}
SimpleSidenavComponent.ɵfac = function SimpleSidenavComponent_Factory(t) { return new (t || SimpleSidenavComponent)(); };
SimpleSidenavComponent.ɵcmp = /*@__PURE__*/ ɵngcc0.ɵɵdefineComponent({ type: SimpleSidenavComponent, selectors: [["sm-simple-sidenav"]], inputs: { menu: "menu", show: "show", animate: "animate", withArrow: "withArrow", activeID: "activeID", animation: "animation" }, outputs: { onSidenav: "onSidenav" }, features: [ɵngcc0.ɵɵNgOnChangesFeature], decls: 1, vars: 1, consts: [["class", "simple-sidenav", 4, "ngIf"], [1, "simple-sidenav"], ["class", "simple-sidenav__item", 4, "ngFor", "ngForOf"], [1, "simple-sidenav__item"], [1, "simple-sidenav__item-content", 3, "ngClass", "click"], ["class", "simple-sidenav__icon", "alt", "icon", 3, "src", 4, "ngIf"], [1, "simple-sidenav__text"], ["class", "simple-sidenav__arrow", 4, "ngIf"], [1, "simple-sidenav-submenu", 3, "animate", "activeID", "animation", "menu", "withArrow", "show", "onSidenav"], ["alt", "icon", 1, "simple-sidenav__icon", 3, "src"], [1, "simple-sidenav__arrow"], ["focusable", "false", "viewBox", "0 0 24 24", "xmlns", "http://www.w3.org/2000/svg"], ["d", "M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z"]], template: function SimpleSidenavComponent_Template(rf, ctx) { if (rf & 1) {
        ɵngcc0.ɵɵtemplate(0, SimpleSidenavComponent_div_0_Template, 2, 3, "div", 0);
    } if (rf & 2) {
        ɵngcc0.ɵɵproperty("ngIf", ctx.show && ctx.menu && ctx.menu.length > 0);
    } }, directives: [ɵngcc1.NgIf, ɵngcc1.NgForOf, ɵngcc1.NgClass, SimpleSidenavComponent], styles: [".simple-sidenav{max-width:360px;overflow:hidden}.simple-sidenav__item{margin-top:3px;overflow:hidden}.simple-sidenav__item-content{position:relative;display:flex;justify-content:flex-start;align-items:center;background-color:#d6d6d6;padding:5px 15px;border-radius:4px}.simple-sidenav__item-content:hover{cursor:pointer}.simple-sidenav__icon{height:35px;margin-right:8px}.simple-sidenav__text{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.simple-sidenav__arrow{position:absolute;width:30px;height:30px;right:12px;top:50%;-webkit-transform:translate(0,-50%);transform:translate(0,-50%)}.simple-sidenav .active{background-color:#b9b9b9}.simple-sidenav-submenu .simple-sidenav{padding-left:15px}"], encapsulation: 2, data: { animation: [fadeIn, fadeOut, rotate] } });
SimpleSidenavComponent.propDecorators = {
    menu: [{ type: Input }],
    show: [{ type: Input }],
    animation: [{ type: Input }],
    animate: [{ type: Input }],
    withArrow: [{ type: Input }],
    activeID: [{ type: Input }],
    onSidenav: [{ type: Output }]
};
(function () { (typeof ngDevMode === "undefined" || ngDevMode) && ɵngcc0.ɵsetClassMetadata(SimpleSidenavComponent, [{
        type: Component,
        args: [{
                selector: 'sm-simple-sidenav',
                template: "<div class=\"simple-sidenav\"\n  *ngIf=\"show && menu && menu.length > 0\"\n  [@fadeIn]=\"animate && animation && animation.in\"\n  [@close]=\"animate && animation && animation.out\">\n  <div class=\"simple-sidenav__item\" *ngFor=\"let item of menu; let menuIndex = index\">\n    <div class=\"simple-sidenav__item-content\" (click)=\"onNavClick(item, menuIndex)\" [ngClass]=\"{'active': item.id === activeOne.id}\">\n      <img class=\"simple-sidenav__icon\" [src]=\"item.icon\" alt=\"icon\" *ngIf=\"item.icon\">\n      <span class=\"simple-sidenav__text\">{{ item.name }}</span>\n      <span class=\"simple-sidenav__arrow\"\n        *ngIf=\"withArrow && item.menu\"\n        [@rotate]=\"item.id === activeOne.id && activeOne.menu ? 'rotated' : 'default'\">\n        <svg focusable=\"false\" viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M8.59 16.34l4.58-4.59-4.58-4.59L10 5.75l6 6-6 6z\"></path></svg>\n      </span>\n    </div>\n    <sm-simple-sidenav\n      class=\"simple-sidenav-submenu\"\n      [animate]=\"true\"\n      [activeID]=\"activeID\"\n      [animation]=\"animation\"\n      [menu]=\"activeOne.menu\"\n      (onSidenav)=\"onSidenav.emit($event)\"\n      [withArrow]=\"withArrow\"\n      [show]=\"item.id === activeOne.id && item.menu\">\n    </sm-simple-sidenav>\n  </div>\n</div>\n",
                encapsulation: ViewEncapsulation.None,
                animations: [fadeIn, fadeOut, rotate],
                styles: [".simple-sidenav{max-width:360px;overflow:hidden}.simple-sidenav__item{margin-top:3px;overflow:hidden}.simple-sidenav__item-content{position:relative;display:flex;justify-content:flex-start;align-items:center;background-color:#d6d6d6;padding:5px 15px;border-radius:4px}.simple-sidenav__item-content:hover{cursor:pointer}.simple-sidenav__icon{height:35px;margin-right:8px}.simple-sidenav__text{text-overflow:ellipsis;overflow:hidden;white-space:nowrap}.simple-sidenav__arrow{position:absolute;width:30px;height:30px;right:12px;top:50%;-webkit-transform:translate(0,-50%);transform:translate(0,-50%)}.simple-sidenav .active{background-color:#b9b9b9}.simple-sidenav-submenu .simple-sidenav{padding-left:15px}"]
            }]
    }], function () { return []; }, { menu: [{
            type: Input
        }], show: [{
            type: Input
        }], animate: [{
            type: Input
        }], withArrow: [{
            type: Input
        }], onSidenav: [{
            type: Output
        }], activeID: [{
            type: Input
        }], animation: [{
            type: Input
        }] }); })();
if (false) {
    /** @type {?} */
    SimpleSidenavComponent.prototype.menu;
    /** @type {?} */
    SimpleSidenavComponent.prototype.show;
    /** @type {?} */
    SimpleSidenavComponent.prototype.animation;
    /** @type {?} */
    SimpleSidenavComponent.prototype.animate;
    /** @type {?} */
    SimpleSidenavComponent.prototype.withArrow;
    /** @type {?} */
    SimpleSidenavComponent.prototype.activeID;
    /** @type {?} */
    SimpleSidenavComponent.prototype.onSidenav;
    /** @type {?} */
    SimpleSidenavComponent.prototype.activeOne;
}

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2ltcGxlLXNpZGVuYXYuY29tcG9uZW50LmpzIiwic291cmNlcyI6WyJzaW1wbGUtc2lkZW5hdi9saWIvc2ltcGxlLXNpZGVuYXYuY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQ0wsU0FBUyxFQUNULEtBQUssRUFDTCxpQkFBaUIsRUFHakIsTUFBTSxFQUNOLFlBQVksRUFDYixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsTUFBTSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFXbEUsTUFBTSxPQUFPLHNCQUFzQjtBQUFHLElBUHRDO0FBQ0csUUFPUSxTQUFJLEdBQWlCLEVBQUUsQ0FBQztBQUNuQyxRQUFXLFNBQUksR0FBWSxJQUFJLENBQUM7QUFDaEMsUUFDVyxZQUFPLEdBQVksS0FBSyxDQUFDO0FBQ3BDLFFBQVcsY0FBUyxHQUFZLElBQUksQ0FBQztBQUNyQyxRQUVFLGNBQVMsR0FLSixJQUFJLFlBQVksRUFLakIsQ0FBQztBQUNQLFFBQ0UsY0FBUyxHQUFlLEVBQUUsQ0FBQztBQUM3QixJQW1DQSxDQUFDO0FBQ0Q7QUFBUTtBQUEwQjtBQUFtQjtBQUFRLElBbkMzRCxXQUFXLENBQUMsT0FBc0I7QUFBSSxRQUNwQyxJQUFJLENBQUMsU0FBUyxHQUFHLEVBQUUsQ0FBQztBQUN4QixRQUNJLElBQUksT0FBTyxDQUFDLFFBQVEsSUFBSSxPQUFPLENBQUMsUUFBUSxDQUFDLFlBQVksRUFBRTtBQUMzRCxZQUFNLElBQUksQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDLFFBQVEsQ0FBQyxZQUFZLENBQUM7QUFDcEQsWUFBTSxJQUFJLENBQUMsUUFBUSxJQUFJLElBQUksQ0FBQyxJQUFJLElBQUksSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDO0FBQ3RELFNBQUs7QUFDTCxJQUFFLENBQUM7QUFDSDtBQUNPO0FBQXNCO0FBQXdCO0FBQ2pEO0FBQVEsSUFEVixVQUFVLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBYyxFQUFFLEtBQWE7QUFBSSxRQUMxRCxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsRUFBRSxLQUFLLEVBQUUsSUFBSSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksRUFBRTtBQUN6RCxZQUFNLElBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDO0FBQzFCLFlBQU0sSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDaEMsWUFBTSxPQUFPO0FBQ2IsU0FBSztBQUNMLFFBQ0ksSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsQ0FBQyxDQUFDO0FBQ25ELFFBQUksSUFBSSxDQUFDLFNBQVMsR0FBRyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLENBQUM7QUFDeEMsUUFDSSxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsSUFBSSxFQUFFO0FBQUUsWUFBQSxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLElBQUksQ0FBQTtBQUFDLFNBQUM7QUFDOUUsSUFBRSxDQUFDO0FBQ0g7QUFDTztBQUNKO0FBQVEsSUFEVCxVQUFVO0FBQUssUUFDYixJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQWdCLEVBQUUsRUFBRTtBQUMzQyxZQUFNLElBQUksSUFBSSxDQUFDLEVBQUUsS0FBSyxJQUFJLENBQUMsUUFBUSxJQUFJLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFO0FBQ2xFLGdCQUFRLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDO0FBQzlCLGdCQUFRLE9BQU87QUFDZixhQUFPO0FBQ1AsUUFBSSxDQUFDLENBQUMsQ0FBQztBQUNQLElBQUUsQ0FBQztBQUNIO0FBQ087QUFBdUI7QUFDeEI7QUFBUSxJQURaLFNBQVMsQ0FBQyxJQUFrQjtBQUFJLFFBQzlCLE9BQU8sSUFBSSxJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxLQUFLLElBQUksQ0FBQyxRQUFRLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztBQUM3RixJQUFFLENBQUM7QUFDSDtrREEvREMsU0FBUyxTQUFDLGtCQUNULFFBQVEsRUFBRSxtQkFBbUI7V0FDN0I7Ozs7VUFBOEMsa0JBRTlDLGFBQWEsRUFBRSxpQkFBaUIsQ0FBQyxJQUFJLGtCQUNyQyxVQUFVLEVBQUUsQ0FBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLE1BQU0sQ0FBQyw0dUJBQ3RDLFVBQ0c7QUFBQztBQUEwQyxtQkFDNUMsS0FBSztBQUFLLG1CQUNWLEtBQUs7QUFBSyx3QkFDVixLQUFLO0FBQUssc0JBQ1YsS0FBSztBQUFLLHdCQUNWLEtBQUs7QUFBSyx1QkFDVixLQUFLO0FBQUssd0JBQ1YsTUFBTTtBQUNSOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7b0JBQUU7QUFBQztBQUFhO0FBQ1AsSUFSUixzQ0FBaUM7QUFDbkM7QUFBcUIsSUFBbkIsc0NBQThCO0FBQ2hDO0FBQXFCLElBQW5CLDJDQUFvQztBQUN0QztBQUFxQixJQUFuQix5Q0FBa0M7QUFDcEM7QUFBcUIsSUFBbkIsMkNBQW1DO0FBQ3JDO0FBQ0EsSUFERSwwQ0FBa0I7QUFDcEI7QUFDUyxJQURQLDJDQVdLO0FBQ1A7QUFDb0IsSUFBbEIsMkNBQTJCO0FBQzdCO0FBQ0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICBDb21wb25lbnQsXG4gIElucHV0LFxuICBWaWV3RW5jYXBzdWxhdGlvbixcbiAgT25DaGFuZ2VzLFxuICBTaW1wbGVDaGFuZ2VzLFxuICBPdXRwdXQsXG4gIEV2ZW50RW1pdHRlclxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IGZhZGVJbiwgZmFkZU91dCwgcm90YXRlIH0gZnJvbSAnLi9hbmltYXRpb25zL2FuaW1hdGlvbnMnO1xuaW1wb3J0IHsgU2ltcGxlTWVudSB9IGZyb20gJy4vaW50ZXJmYWNlcy9zaW1wbGUtbWVudSc7XG5pbXBvcnQgeyBTaW1wbGVBbmltYXRpb24gfSBmcm9tICcuL2ludGVyZmFjZXMvc2ltcGxlLWFuaW1hdGlvbic7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ3NtLXNpbXBsZS1zaWRlbmF2JyxcbiAgdGVtcGxhdGVVcmw6ICcuL3NpbXBsZS1zaWRlbmF2LmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vc2ltcGxlLXNpZGVuYXYuY29tcG9uZW50LnNjc3MnXSxcbiAgZW5jYXBzdWxhdGlvbjogVmlld0VuY2Fwc3VsYXRpb24uTm9uZSxcbiAgYW5pbWF0aW9uczogW2ZhZGVJbiwgZmFkZU91dCwgcm90YXRlXVxufSlcbmV4cG9ydCBjbGFzcyBTaW1wbGVTaWRlbmF2Q29tcG9uZW50IGltcGxlbWVudHMgT25DaGFuZ2VzIHtcbiAgQElucHV0KCkgbWVudTogU2ltcGxlTWVudVtdID0gW107XG4gIEBJbnB1dCgpIHNob3c6IGJvb2xlYW4gPSB0cnVlO1xuICBASW5wdXQoKSBhbmltYXRpb246IFNpbXBsZUFuaW1hdGlvbjtcbiAgQElucHV0KCkgYW5pbWF0ZTogYm9vbGVhbiA9IGZhbHNlO1xuICBASW5wdXQoKSB3aXRoQXJyb3c6IGJvb2xlYW4gPSB0cnVlO1xuICBASW5wdXQoKSBhY3RpdmVJRDtcbiAgQE91dHB1dCgpXG4gIG9uU2lkZW5hdjogRXZlbnRFbWl0dGVyPHtcbiAgICBpZDogc3RyaW5nfG51bWJlcixcbiAgICBuYW1lOiBzdHJpbmcsXG4gICAgaWNvbjogc3RyaW5nLFxuICAgIGluZGV4OiBudW1iZXJcbiAgfT4gPSBuZXcgRXZlbnRFbWl0dGVyPHtcbiAgICBpZDogc3RyaW5nfG51bWJlcixcbiAgICBuYW1lOiBzdHJpbmcsXG4gICAgaWNvbjogc3RyaW5nLFxuICAgIGluZGV4OiBudW1iZXJcbiAgfT4oKTtcblxuICBhY3RpdmVPbmU6IFNpbXBsZU1lbnUgPSB7fTtcblxuICBuZ09uQ2hhbmdlcyhjaGFuZ2VzOiBTaW1wbGVDaGFuZ2VzKTogdm9pZCB7XG4gICAgdGhpcy5hY3RpdmVPbmUgPSB7fTtcblxuICAgIGlmIChjaGFuZ2VzLmFjdGl2ZUlEICYmIGNoYW5nZXMuYWN0aXZlSUQuY3VycmVudFZhbHVlKSB7XG4gICAgICB0aGlzLmFjdGl2ZUlEID0gY2hhbmdlcy5hY3RpdmVJRC5jdXJyZW50VmFsdWU7XG4gICAgICB0aGlzLmFjdGl2ZUlEICYmIHRoaXMubWVudSAmJiB0aGlzLmZpbmRBY3RpdmUoKTtcbiAgICB9XG4gIH1cblxuICBvbk5hdkNsaWNrKHsgaWQsIG5hbWUsIGljb24gfTogU2ltcGxlTWVudSwgaW5kZXg6IG51bWJlcik6IHZvaWQge1xuICAgIGlmICh0aGlzLmFjdGl2ZU9uZS5pZCA9PT0gaWQgJiYgdGhpcy5hY3RpdmVPbmUubWVudSkge1xuICAgICAgdGhpcy5hY3RpdmVPbmUgPSB7fTtcbiAgICAgIHRoaXMub25TaWRlbmF2LmVtaXQobnVsbCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdGhpcy5vblNpZGVuYXYuZW1pdCh7IGlkLCBuYW1lLCBpY29uLCBpbmRleCB9KTtcbiAgICB0aGlzLmFjdGl2ZU9uZSA9IHsgaWQsIG5hbWUsIGljb24gfTtcblxuICAgIGlmICh0aGlzLm1lbnVbaW5kZXhdLm1lbnUpIHsgdGhpcy5hY3RpdmVPbmUubWVudSA9IHRoaXMubWVudVtpbmRleF0ubWVudSB9XG4gIH1cblxuICBmaW5kQWN0aXZlKCk6IHZvaWQge1xuICAgIHRoaXMubWVudS5mb3JFYWNoKChpdGVtOiBTaW1wbGVNZW51KSA9PiB7XG4gICAgICBpZiAoaXRlbS5pZCA9PT0gdGhpcy5hY3RpdmVJRCB8fCB0aGlzLmhhc0FjdGl2ZShpdGVtLm1lbnUpKSB7XG4gICAgICAgIHRoaXMuYWN0aXZlT25lID0gaXRlbTtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgaGFzQWN0aXZlKG1lbnU6IFNpbXBsZU1lbnVbXSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBtZW51ICYmIG1lbnUuc29tZShpdGVtID0+IGl0ZW0uaWQgPT09IHRoaXMuYWN0aXZlSUQgfHwgdGhpcy5oYXNBY3RpdmUoaXRlbS5tZW51KSk7XG4gIH1cbn1cbiJdfQ==